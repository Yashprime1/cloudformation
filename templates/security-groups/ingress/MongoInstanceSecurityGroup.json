{
    "AWSTemplateFormatVersion":"2010-09-09",
    "Parameters":{
        "RegionPrefix":{
            "Type":"String",
            "Default":""
        }
    },
    "Resources":{
        "MongoToMMongoInstanceSecurityGroupIngressRule":{
            "Type":"AWS::EC2::SecurityGroupIngress",
            "Properties":{
                "GroupId":{
                    "Fn::ImportValue":{
                        "Fn::Join":[
                            "-",
                            [
                                {
                                    "Ref":"RegionPrefix"
                                },
                                "MongoInstanceSecurityGroupId"
                            ]
                        ]
                    }
                },
                "SourceSecurityGroupId":{
                    "Fn::ImportValue":{
                        "Fn::Join":[
                            "-",
                            [
                                {
                                    "Ref":"RegionPrefix"
                                },
                                "MongoInstanceSecurityGroupId"
                            ]
                        ]
                    }
                },
                "IpProtocol":"tcp",
                "FromPort":"27017",
                "ToPort":"27017"
            }
        },
        "PublicTrafficToMongoInstanceSecurityGroupIngressRule":{
            "Type":"AWS::EC2::SecurityGroupIngress",
            "Properties":{
                "GroupId":{
                    "Fn::ImportValue":{
                        "Fn::Join":[
                            "-",
                            [
                                {
                                    "Ref":"RegionPrefix"
                                },
                                "MongoInstanceSecurityGroupId"
                            ]
                        ]
                    }
                },
                "CidrIp":"0.0.0.0/0",
                "IpProtocol":"tcp",
                "FromPort":"27017",
                "ToPort":"27017"
            }
        },
        "PublicTrafficToMongoInstanceSecurityGroupSSHIngressRule":{
            "Type":"AWS::EC2::SecurityGroupIngress",
            "Properties":{
                "GroupId":{
                    "Fn::ImportValue":{
                        "Fn::Join":[
                            "-",
                            [
                                {
                                    "Ref":"RegionPrefix"
                                },
                                "MongoInstanceSecurityGroupId"
                            ]
                        ]
                    }
                },
                "CidrIp":"0.0.0.0/0",
                "IpProtocol":"tcp",
                "FromPort":"22",
                "ToPort":"22"
            }
        },
        "PublicTrafficToMongoInstanceSecurityGroupSSHIngressRule":{
            "Type":"AWS::EC2::SecurityGroupIngress",
            "Properties":{
                "GroupId":{
                    "Fn::ImportValue":{
                        "Fn::Join":[
                            "-",
                            [
                                {
                                    "Ref":"RegionPrefix"
                                },
                                "MongoInstanceSecurityGroupId"
                            ]
                        ]
                    }
                },
                "CidrIp":"0.0.0.0/0",
                "IpProtocol":"tcp",
                "FromPort":"443",
                "ToPort":"443"
            }
        },
        "MyIpAllTrafficToMongoInstanceSecurityGroupIngressRule":{
            "Type":"AWS::EC2::SecurityGroupIngress",
            "Properties":{
                "GroupId":{
                    "Fn::ImportValue":{
                        "Fn::Join":[
                            "-",
                            [
                                {
                                    "Ref":"RegionPrefix"
                                },
                                "MongoInstanceSecurityGroupId"
                            ]
                        ]
                    }
                },
                "CidrIp":"1.38.220.231",
                "IpProtocol":"-1"
            }
        }   
    }
}